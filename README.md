# Django-Blog Mini Project

A simple blog app written using Django

'[![Build Status](https://travis-ci.org/jjackson19862017/django-blog.svg?branch=master)](https://travis-ci.org/jjackson19862017/django-blog)'
 
# Init Setup

## Install django
'sudo pip3 install django==1.11.24'

## Requirements file
'pip3 freeze > requirements.txt' --> My shortcut is 'makereq'

## Start project
'django-admin startproject' --> My shortcut is 'pstart'

so you would use 'pstart blog .'

You may need to make the manage.py file executable

'chmod +x manage.py'

## Migrate

'python3 manage.py migrate' --> My shortcut is 'migrate'

## Local Settings

Creating hidden git ignore and env.py

'echo env.py > .gitignore' --> My shortcut is 'gignore'
'echo import os > env.py' --> My shortcut is 'makeenv'

add this code to just below the import section in settings.py

'from os import path
if path.exists("env.py"):
  import env'

## Change Secret Key

and change the Secret Key (LINE 36)

'SECRET_KEY = os.environ.get('SECRET_KEY')'

KEY - can be generated by https://miniwebtool.com/django-secret-key-generator/

'os.environ["SECRET_KEY"] = "[KEY]"'

## Hostname

in env.py

'os.environ["HOSTNAME"] = "127.0.0.1"'

in settings.py (LINE 41)

'ALLOWED_HOSTS = [os.environ.get('HOSTNAME')]'

## Setting up Travis

https://travis-ci.org/ - Link the Repo to this so that you can test things.

Once you have linked the Repo, click on the Repo, look where it says "Build:Unknown: and Click on "Unknown".

Change the drop down to Markdown and copy the code underneath it.

'[![Build Status](https://travis-ci.org/jjackson19862017/django-blog.svg?branch=master)](https://travis-ci.org/jjackson19862017/django-blog)'

Create a file called '.travis.yml' and place this in the blog folder

Add this code to it
'
language: python
python:
    - "3.7"
install: "pip3 install -r requirements.txt"
script:
- SECRET_KEY="whatever" ./manage.py test
'

## Fixing Travis

Changed 3.7 from 3.4 otherwise it would fail.

# Create a New App called 'post'

Create a new app using the terminal command
'django-admin startapp posts' --> My Shortcut is 'astart' [app name]

## Post Directory

create 'templates' folder
create forms.py 'touch forms.py'

## Top Directory

create the following folders using the terminal commands.

'mkdir media static
cd media
mkdir img
cd ..
cd static
mkdir css img js'

## Update Settings.py

Because we have add posts app we need to update the settings.py

Add to INSTALLED_APPS -> 'posts',

In TEMPLATES -> 'DIRS'

Add the following code between the square brackets

'os.path.join(BASE_DIR, 'templates')'

Should look something like this ->         "'DIRS': [os.path.join(BASE_DIR, 'templates')],"

In TEMPLATES -> OPTIONS

Add the following code between the square brackets

'
'django.template.context_processors.media',
'

At the Bottom of the file, underneath STATIC_URL, Add this:

'
STATICFILES_DIRS = (os.path.join(BASE_DIR, 'static'),)

MEDIA_URL = '/media/'
MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
'

## models.py (Post Diectory)

Add this code to the file

'
from django.utils import timezone

# Create your models here.
class Post(models.Model):
    """
    A Single Blog post
    """
    title = models.CharField(max_length=200)
    content = models.TextField()
    created_date= models.DateTimeField(auto_now_add=True)
    published_date = models.DateTimeField(blank=True, null=True, default=timezone.now)
    views = models.IntegerField(default=0)
    tag = models.CharField(max_length=30, blank=True, null=True)
    image = models.ImageField(upload_to="img", blank=True, null=True)

    def __unicode__(self):
        return self.title
'

after saving I got an error, about Pillow not being installed.

'sudo pip3 install Pillow' fixed that.

ran 'makereq' to update requirements file.

## forms.py (posts Directory)

Add this code to the file.

This will use the models.py file we have populated with code to create a form out of it.

We are only using user editable fields.

'
from django import forms
from .models import Post

class BlogPostForm(forms.ModelForm):
    class Meta:
        model = Post
        fields = ('title','content','image','tag','published_date')
'

## admin.py (posts Directory)

'from django.contrib import admin
from .models import Post
# Register your models here.

admin.site.register(Post)'